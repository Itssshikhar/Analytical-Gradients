2025-02-28 10:19:23,884 - __main__ - INFO - Arguments: Namespace(output_dir='outputs/gemma-2-2b', cache_dir='outputs/gemma-2-2b/cache', log_file='outputs/gemma-2-2b/gemma-2-2b.log', log_level='INFO', seed=42, model_name='google/gemma-2-2b', sae_source='gemma_scope', layers='6,7,8,9,10,11,12', num_examples=200, test_size=0.2, correct_only=False, batch_size=1, top_k=20, save_interval=10, dtype='float16', device='cuda')
2025-02-28 10:19:23,884 - __main__ - INFO - Loading model and tokenizer: google/gemma-2-2b
2025-02-28 10:19:34,200 - __main__ - INFO - Analyzing layers: [6, 7, 8, 9, 10, 11, 12]
2025-02-28 10:19:34,200 - __main__ - INFO - Loading SAE decoder weights from source: gemma_scope
2025-02-28 10:19:35,012 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_6/width_16k/canonical
2025-02-28 10:19:37,402 - model.sae_utils - INFO - Loaded decoder weights for layer 6 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:37,402 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_7/width_16k/canonical
2025-02-28 10:19:38,455 - model.sae_utils - INFO - Loaded decoder weights for layer 7 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:38,455 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_8/width_16k/canonical
2025-02-28 10:19:39,565 - model.sae_utils - INFO - Loaded decoder weights for layer 8 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:39,565 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_9/width_16k/canonical
2025-02-28 10:19:40,662 - model.sae_utils - INFO - Loaded decoder weights for layer 9 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:40,662 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_10/width_16k/canonical
2025-02-28 10:19:41,775 - model.sae_utils - INFO - Loaded decoder weights for layer 10 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:41,776 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_11/width_16k/canonical
2025-02-28 10:19:42,877 - model.sae_utils - INFO - Loaded decoder weights for layer 11 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:42,878 - model.sae_utils - INFO - Loading SAE from gemma-scope-2b-pt-res-canonical, sae_id: layer_12/width_16k/canonical
2025-02-28 10:19:43,969 - model.sae_utils - INFO - Loaded decoder weights for layer 12 with shape torch.Size([16384, 2304]), avg L0: None
2025-02-28 10:19:43,970 - __main__ - INFO - Preparing dataset with 200 examples
2025-02-28 10:19:43,970 - data.dataset - INFO - Generating 200 subject-verb agreement examples
2025-02-28 10:19:44,550 - __main__ - INFO - Created dataset with 320 training and 80 test examples
2025-02-28 10:19:44,550 - __main__ - INFO - Initializing Analytical Gradient
2025-02-28 10:19:45,164 - model.analytical_gradient - INFO - Analytical Gradient initialized with 7 layers
2025-02-28 10:19:45,164 - model.analytical_gradient - INFO - Using device: cuda, dtype: torch.float16
2025-02-28 10:19:45,164 - __main__ - INFO - Running analysis on training set
2025-02-28 10:19:45,165 - model.analytical_gradient - INFO - Starting analysis of 320 examples
2025-02-28 10:19:47,341 - model.analytical_gradient - INFO - Processed 11 examples. Saving intermediate results...
2025-02-28 10:19:48,748 - model.analytical_gradient - INFO - Processed 21 examples. Saving intermediate results...
2025-02-28 10:19:50,126 - model.analytical_gradient - INFO - Processed 31 examples. Saving intermediate results...
2025-02-28 10:19:51,476 - model.analytical_gradient - INFO - Processed 41 examples. Saving intermediate results...
2025-02-28 10:19:52,842 - model.analytical_gradient - INFO - Processed 51 examples. Saving intermediate results...
2025-02-28 10:19:54,202 - model.analytical_gradient - INFO - Processed 61 examples. Saving intermediate results...
2025-02-28 10:19:55,567 - model.analytical_gradient - INFO - Processed 71 examples. Saving intermediate results...
2025-02-28 10:19:56,930 - model.analytical_gradient - INFO - Processed 81 examples. Saving intermediate results...
2025-02-28 10:19:58,285 - model.analytical_gradient - INFO - Processed 91 examples. Saving intermediate results...
2025-02-28 10:19:59,628 - model.analytical_gradient - INFO - Processed 101 examples. Saving intermediate results...
2025-02-28 10:20:00,990 - model.analytical_gradient - INFO - Processed 111 examples. Saving intermediate results...
2025-02-28 10:20:02,340 - model.analytical_gradient - INFO - Processed 121 examples. Saving intermediate results...
2025-02-28 10:20:03,697 - model.analytical_gradient - INFO - Processed 131 examples. Saving intermediate results...
2025-02-28 10:20:05,048 - model.analytical_gradient - INFO - Processed 141 examples. Saving intermediate results...
2025-02-28 10:20:06,643 - model.analytical_gradient - INFO - Processed 151 examples. Saving intermediate results...
2025-02-28 10:20:08,002 - model.analytical_gradient - INFO - Processed 161 examples. Saving intermediate results...
2025-02-28 10:20:09,360 - model.analytical_gradient - INFO - Processed 171 examples. Saving intermediate results...
2025-02-28 10:20:10,739 - model.analytical_gradient - INFO - Processed 181 examples. Saving intermediate results...
2025-02-28 10:20:12,108 - model.analytical_gradient - INFO - Processed 191 examples. Saving intermediate results...
2025-02-28 10:20:13,471 - model.analytical_gradient - INFO - Processed 201 examples. Saving intermediate results...
2025-02-28 10:20:14,882 - model.analytical_gradient - INFO - Processed 211 examples. Saving intermediate results...
2025-02-28 10:20:16,247 - model.analytical_gradient - INFO - Processed 221 examples. Saving intermediate results...
2025-02-28 10:20:17,631 - model.analytical_gradient - INFO - Processed 231 examples. Saving intermediate results...
2025-02-28 10:20:19,019 - model.analytical_gradient - INFO - Processed 241 examples. Saving intermediate results...
2025-02-28 10:20:20,407 - model.analytical_gradient - INFO - Processed 251 examples. Saving intermediate results...
2025-02-28 10:20:21,765 - model.analytical_gradient - INFO - Processed 261 examples. Saving intermediate results...
2025-02-28 10:20:23,152 - model.analytical_gradient - INFO - Processed 271 examples. Saving intermediate results...
2025-02-28 10:20:24,531 - model.analytical_gradient - INFO - Processed 281 examples. Saving intermediate results...
2025-02-28 10:20:25,893 - model.analytical_gradient - INFO - Processed 291 examples. Saving intermediate results...
2025-02-28 10:20:27,249 - model.analytical_gradient - INFO - Processed 301 examples. Saving intermediate results...
2025-02-28 10:20:28,609 - model.analytical_gradient - INFO - Processed 311 examples. Saving intermediate results...
2025-02-28 10:20:29,812 - model.analytical_gradient - INFO - Analysis completed in 44.65 seconds
2025-02-28 10:20:29,812 - model.analytical_gradient - INFO - Results saved to outputs/gemma-2-2b/cache/train_results_final.json
2025-02-28 10:20:29,832 - __main__ - INFO - Running analysis on test set
2025-02-28 10:20:29,835 - model.analytical_gradient - INFO - Starting analysis of 80 examples
2025-02-28 10:20:31,296 - model.analytical_gradient - INFO - Processed 11 examples. Saving intermediate results...
2025-02-28 10:20:32,654 - model.analytical_gradient - INFO - Processed 21 examples. Saving intermediate results...
2025-02-28 10:20:34,035 - model.analytical_gradient - INFO - Processed 31 examples. Saving intermediate results...
2025-02-28 10:20:35,413 - model.analytical_gradient - INFO - Processed 41 examples. Saving intermediate results...
2025-02-28 10:20:36,786 - model.analytical_gradient - INFO - Processed 51 examples. Saving intermediate results...
2025-02-28 10:20:38,146 - model.analytical_gradient - INFO - Processed 61 examples. Saving intermediate results...
2025-02-28 10:20:39,523 - model.analytical_gradient - INFO - Processed 71 examples. Saving intermediate results...
2025-02-28 10:20:40,781 - model.analytical_gradient - INFO - Analysis completed in 10.95 seconds
2025-02-28 10:20:40,782 - model.analytical_gradient - INFO - Results saved to outputs/gemma-2-2b/cache/test_results_final.json
2025-02-28 10:20:40,789 - __main__ - INFO - Analysis completed
